<html>

<head>
    <title>Leaflet sample</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <script src="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/js/bootstrap.js"></script>
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDBaa39myv9d7Uk4p2aHoYPvPNU-eU8kfU&callback=initMap&libraries=&v=weekly"
        defer></script>
    <style type="text/css" media="screen">
        html {
            height: 100%;
            width: 100%;
            background-image: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
        }

        #map {
            position: absolute;
            left: 0;
            height: 80%;
            width: 80vw;
        }

        #body {
            height: 100%;
            width: 100vw;
            position: relative;
            top: 0;
            left: 0;
        }
    </style>
</head>

<body>
    <div class="body">
        <div id="map"></div>
    </div>
    <% items.forEach((item)=>{%>
        <script>
            function initMap() {
                var latlng = { lat: '<%=item.inventory_address.coord.latitude%>', lng: '<%=item.inventory_address.coord.longitude%>' };
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 18,
                    center: latlng
                });
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map
                });
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function (position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        var marker = new google.maps.Marker({
                            position: pos,
                            icon: 'marker.png',
                            map: map
                        });
                        map.setZoom(14);
                        map.setCenter(pos);
                    });
                } else {
                    alert("error!");
                }
            }

            function back() {
                location.href = '/detail?_id=<%=item._id%>'
            }
        </script>
        <br>
        <button onclick="back()">Back</button>
        <%})%>
</body>

</html>